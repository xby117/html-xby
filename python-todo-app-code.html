<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TECH·G | 全栈任务管理系统 - 示例代码</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        html, body { height: 100%; overflow-x: hidden; background: #000; color: #f5f5f5; }
        
        /* 返回按钮 */
        .back-container { padding: clamp(20px, 4vw, 24px) clamp(16px, 5vw, 40px); text-align: left; }
        .back-btn { 
            padding: clamp(6px, 1.5vw, 8px) clamp(16px, 2vw, 20px); 
            background: rgba(249, 115, 22, 0.1); color: #f97316; 
            text-decoration: none; border-radius: 4px; transition: all 0.3s ease; 
            font-size: clamp(12px, 1.8vw, 14px); display: inline-block; 
        }
        .back-btn:hover { background: rgba(249, 115, 22, 0.2); transform: translateY(-2px); }
        
        /* 代码区域 */
        .code-section { 
            width: 100%; padding: clamp(20px, 5vw, 40px) clamp(16px, 5vw, 40px); 
            max-width: 1200px; margin: 0 auto; min-height: calc(100vh - 120px); 
        }
        .code-title { 
            font-size: clamp(18px, 3vw, 22px); color: #fff; margin-bottom: clamp(20px, 4vw, 30px); 
            position: relative; display: inline-block; 
        }
        .code-title::after { 
            content: ''; display: block; width: clamp(50px, 10vw, 50px); height: 2px; 
            background: #22c55e; margin: 8px 0 0; 
        }
        .code-description { 
            font-size: clamp(13px, 2vw, 15px); color: #aaa; line-height: 1.6; 
            margin-bottom: clamp(20px, 3vw, 24px); 
        }
        .code-tabs { display: flex; gap: clamp(8px, 1.5vw, 12px); margin-bottom: clamp(16px, 2vw, 20px); }
        .code-tab { 
            padding: clamp(6px, 1.5vw, 8px) clamp(16px, 2vw, 20px); 
            background: #111; color: #ccc; border: none; border-radius: 4px; 
            cursor: pointer; transition: all 0.3s ease; font-size: clamp(12px, 1.8vw, 14px); 
        }
        .code-tab.active { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .code-card { 
            background: #0a0a0a; border-radius: 8px; padding: clamp(20px, 3vw, 24px); 
            position: relative; border: 1px solid rgba(34, 197, 94, 0.1); display: none; 
        }
        .code-card.active { display: block; }
        .copy-btn { 
            position: absolute; top: clamp(16px, 2vw, 20px); right: clamp(16px, 2vw, 20px); 
            padding: clamp(4px, 1vw, 6px) clamp(12px, 1.5vw, 16px); 
            background: rgba(34, 197, 94, 0.1); color: #22c55e; 
            border: none; border-radius: 4px; font-size: clamp(11px, 1.5vw, 12px); 
            cursor: pointer; transition: all 0.3s ease; 
            z-index: 10;
        }
        .copy-btn:hover { background: rgba(34, 197, 94, 0.2); }
        .copy-success { 
            position: absolute; top: clamp(16px, 2vw, 20px); right: clamp(100px, 10vw, 120px); 
            color: #22c55e; font-size: clamp(11px, 1.5vw, 12px); 
            background: rgba(34, 197, 94, 0.1); padding: clamp(4px, 1vw, 6px) clamp(12px, 1.5vw, 16px); 
            border-radius: 4px; border: 1px solid rgba(34, 197, 94, 0.3);
            display: none; opacity: 0; transition: opacity 0.3s ease;
            z-index: 10;
        }
        .copy-success.show { 
            display: inline-block; opacity: 1; 
            animation: fadeInOut 1.5s ease-in-out;
        }
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(5px); }
            20% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(5px); }
        }
        pre { 
            white-space: pre-wrap; word-break: break-all; overflow-x: auto; 
            font-size: clamp(12px, 1.8vw, 14px); line-height: 1.6; 
            padding-top: clamp(8px, 1vw, 10px);
            max-height: 70vh; /* 限制代码块高度，避免溢出 */
        }
        code { color: #d1d5db; }
        .keyword { color: #c084fc; }
        .string { color: #facc15; }
        .comment { color: #6b7280; }
        .function { color: #38bdf8; }
        .variable { color: #a78bfa; }
        .number { color: #f87171; }
        .html-tag { color: #f87171; }
        .css-property { color: #38bdf8; }
        .css-value { color: #facc15; }
        
        /* 页脚 */
        .footer { 
            width: 100%; padding: clamp(16px, 3vw, 20px) 0; 
            text-align: center; color: #888; font-size: clamp(11px, 2vw, 12px); 
            background: rgba(0, 0, 0, 0.9); border-top: 1px solid rgba(34, 197, 94, 0.1);
        }
    </style>
</head>
<body>
    <div class="back-container">
        <a href="python-todo-app.html" class="back-btn">返回功能详情</a>
    </div>

    <section class="code-section">
        <h1 class="code-title">全栈任务管理系统 - 核心示例代码</h1>
        <p class="code-description">包含 Flask 后端 API、SQLite 数据库模型和前端交互逻辑，完整实现任务 CRUD 功能：</p>
        
        <!-- 代码标签页 -->
        <div class="code-tabs">
            <button class="code-tab active" onclick="switchTab('backend')">后端（Flask）</button>
            <button class="code-tab" onclick="switchTab('frontend')">前端（JS/HTML/CSS）</button>
        </div>
        
        <!-- 后端代码 -->
        <div class="code-card active" id="backend-card">
            <button class="copy-btn" onclick="copyCode('backend')">复制代码</button>
            <span class="copy-success" id="backend-success">复制成功！</span>
            <pre><code><span class="comment"># app.py - Flask 后端核心代码</span>
<span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, session
<span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime
<span class="keyword">import</span> hashlib
<span class="keyword">import</span> os

<span class="comment"># 初始化 Flask 应用</span>
app = Flask(__name__)
app.config[<span class="string">'SECRET_KEY'</span>] = os.urandom(<span class="number">24</span>)  <span class="comment"># 会话密钥</span>
app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///todo.db'</span>  <span class="comment">SQLite 数据库</span>
app.config[<span class="string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class="keyword">False</span>
db = SQLAlchemy(app)

<span class="comment"># 1. 用户模型</span>
<span class="keyword">class</span> <span class="function">User</span>(db.Model):
    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)
    username = db.Column(db.String(50), unique=<span class="keyword">True</span>, nullable=<span class="keyword">False</span>)
    password = db.Column(db.String(128), nullable=<span class="keyword">False</span>)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    todos = db.relationship(<span class="string">'Todo'</span>, backref=<span class="string">'author'</span>, lazy=<span class="string">'dynamic'</span>, cascade=<span class="string">'all, delete-orphan'</span>)

    <span class="comment"># 密码加密</span>
    <span class="keyword">def</span> <span class="function">set_password</span>(self, password):
        self.password = hashlib.sha256(password.encode(<span class="string">'utf-8'</span>)).hexdigest()

    <span class="comment"># 密码验证</span>
    <span class="keyword">def</span> <span class="function">check_password</span>(self, password):
        <span class="keyword">return</span> self.password == hashlib.sha256(password.encode(<span class="string">'utf-8'</span>)).hexdigest()

<span class="comment"># 2. 任务模型</span>
<span class="keyword">class</span> <span class="function">Todo</span>(db.Model):
    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)
    title = db.Column(db.String(100), nullable=<span class="keyword">False</span>)
    description = db.Column(db.Text, nullable=<span class="keyword">True</span>)
    status = db.Column(db.String(20), default=<span class="string">'pending'</span>)  <span class="comment"># pending/doing/done</span>
    priority = db.Column(db.String(10), default=<span class="string">'medium'</span>)  <span class="comment"># high/medium/low</span>
    deadline = db.Column(db.DateTime, nullable=<span class="keyword">True</span>)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    user_id = db.Column(db.Integer, db.ForeignKey(<span class="string">'user.id'</span>), nullable=<span class="keyword">False</span>)

<span class="comment"># 3. 辅助函数 - 登录验证装饰器</span>
<span class="keyword">def</span> <span class="function">login_required</span>(func):
    <span class="keyword">from</span> functools <span class="keyword">import</span> wraps
    @wraps(func)
    <span class="keyword">def</span> <span class="function">wrapper</span>(*args, **kwargs):
        <span class="keyword">if</span> <span class="string">'user_id'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:
            <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">401</span>, <span class="string">'msg'</span>: <span class="string">'请先登录'</span>}), <span class="number">401</span>
        <span class="keyword">return</span> func(*args, **kwargs)
    <span class="keyword">return</span> wrapper

<span class="comment"># 4. 用户相关接口</span>
<span class="comment"># 注册</span>
@app.route(<span class="string">'/api/register'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">def</span> <span class="function">register</span>():
    data = request.get_json()
    username = data.get(<span class="string">'username'</span>)
    password = data.get(<span class="string">'password'</span>)
    
    <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">400</span>, <span class="string">'msg'</span>: <span class="string">'用户名和密码不能为空'</span>}), <span class="number">400</span>
    
    <span class="keyword">if</span> User.query.filter_by(username=username).first():
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">400</span>, <span class="string">'msg'</span>: <span class="string">'用户名已存在'</span>}), <span class="number">400</span>
    
    user = User(username=username)
    user.set_password(password)
    db.session.add(user)
    db.session.commit()
    
    <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">200</span>, <span class="string">'msg'</span>: <span class="string">'注册成功'</span>})

<span class="comment"># 登录</span>
@app.route(<span class="string">'/api/login'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">def</span> <span class="function">login</span>():
    data = request.get_json()
    username = data.get(<span class="string">'username'</span>)
    password = data.get(<span class="string">'password'</span>)
    
    user = User.query.filter_by(username=username).first()
    <span class="keyword">if</span> <span class="keyword">not</span> user <span class="keyword">or</span> <span class="keyword">not</span> user.check_password(password):
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">401</span>, <span class="string">'msg'</span>: <span class="string">'用户名或密码错误'</span>}), <span class="number">401</span>
    
    session[<span class="string">'user_id'</span>] = user.id
    <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">200</span>, <span class="string">'msg'</span>: <span class="string">'登录成功'</span>, <span class="string">'data'</span>: {<span class="string">'username'</span>: username}})

<span class="comment"># 退出登录</span>
@app.route(<span class="string">'/api/logout'</span>, methods=[<span class="string">'POST'</span>])
@login_required
<span class="keyword">def</span> <span class="function">logout</span>():
    session.pop(<span class="string">'user_id'</span>, <span class="keyword">None</span>)
    <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">200</span>, <span class="string">'msg'</span>: <span class="string">'退出登录成功'</span>})

<span class="comment"># 5. 任务相关接口</span>
<span class="comment"># 创建任务</span>
@app.route(<span class="string">'/api/todos'</span>, methods=[<span class="string">'POST'</span>])
@login_required
<span class="keyword">def</span> <span class="function">create_todo</span>():
    data = request.get_json()
    title = data.get(<span class="string">'title'</span>)
    description = data.get(<span class="string">'description'</span>, <span class="string">''</span>)
    priority = data.get(<span class="string">'priority'</span>, <span class="string">'medium'</span>)
    deadline_str = data.get(<span class="string">'deadline'</span>)
    
    <span class="keyword">if</span> <span class="keyword">not</span> title:
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">400</span>, <span class="string">'msg'</span>: <span class="string">'任务标题不能为空'</span>}), <span class="number">400</span>
    
    <span class="comment"># 解析截止日期</span>
    deadline = None
    <span class="keyword">if</span> deadline_str:
        <span class="keyword">try</span>:
            deadline = datetime.strptime(deadline_str, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)
        <span class="keyword">except</span>:
            <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">400</span>, <span class="string">'msg'</span>: <span class="string">'日期格式错误，应为 YYYY-MM-DD HH:MM:SS'</span>}), <span class="number">400</span>
    
    todo = Todo(
        title=title,
        description=description,
        priority=priority,
        deadline=deadline,
        user_id=session[<span class="string">'user_id'</span>]
    )
    db.session.add(todo)
    db.session.commit()
    
    <span class="keyword">return</span> jsonify({
        <span class="string">'code'</span>: <span class="number">200</span>, 
        <span class="string">'msg'</span>: <span class="string">'任务创建成功'</span>,
        <span class="string">'data'</span>: {
            <span class="string">'id'</span>: todo.id,
            <span class="string">'title'</span>: todo.title,
            <span class="string">'status'</span>: todo.status,
            <span class="string">'created_at'</span>: todo.created_at.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>)
        }
    })

<span class="comment"># 获取所有任务</span>
@app.route(<span class="string">'/api/todos'</span>, methods=[<span class="string">'GET'</span>])
@login_required
<span class="keyword">def</span> <span class="function">get_todos</span>():
    <span class="comment"># 支持按状态筛选</span>
    status = request.args.get(<span class="string">'status'</span>)
    <span class="keyword">if</span> status <span class="keyword">and</span> status <span class="keyword">in</span> [<span class="string">'pending'</span>, <span class="string">'doing'</span>, <span class="string">'done'</span>]:
        todos = Todo.query.filter_by(user_id=session[<span class="string">'user_id'</span>], status=status).order_by(Todo.updated_at.desc()).all()
    <span class="keyword">else</span>:
        todos = Todo.query.filter_by(user_id=session[<span class="string">'user_id'</span>]).order_by(Todo.updated_at.desc()).all()
    
    result = []
    <span class="keyword">for</span> todo <span class="keyword">in</span> todos:
        result.append({
            <span class="string">'id'</span>: todo.id,
            <span class="string">'title'</span>: todo.title,
            <span class="string">'description'</span>: todo.description,
            <span class="string">'status'</span>: todo.status,
            <span class="string">'priority'</span>: todo.priority,
            <span class="string">'deadline'</span>: todo.deadline.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>) <span class="keyword">if</span> todo.deadline <span class="keyword">else</span> <span class="string">''</span>,
            <span class="string">'created_at'</span>: todo.created_at.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>),
            <span class="string">'updated_at'</span>: todo.updated_at.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>)
        })
    
    <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">200</span>, <span class="string">'data'</span>: result})

<span class="comment"># 获取单个任务</span>
@app.route(<span class="string">'/api/todos/&lt;int:todo_id&gt;'</span>, methods=[<span class="string">'GET'</span>])
@login_required
<span class="keyword">def</span> <span class="function">get_todo</span>(todo_id):
    todo = Todo.query.filter_by(id=todo_id, user_id=session[<span class="string">'user_id'</span>]).first()
    <span class="keyword">if</span> <span class="keyword">not</span> todo:
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">404</span>, <span class="string">'msg'</span>: <span class="string">'任务不存在'</span>}), <span class="number">404</span>
    
    <span class="keyword">return</span> jsonify({
        <span class="string">'code'</span>: <span class="number">200</span>,
        <span class="string">'data'</span>: {
            <span class="string">'id'</span>: todo.id,
            <span class="string">'title'</span>: todo.title,
            <span class="string">'description'</span>: todo.description,
            <span class="string">'status'</span>: todo.status,
            <span class="string">'priority'</span>: todo.priority,
            <span class="string">'deadline'</span>: todo.deadline.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>) <span class="keyword">if</span> todo.deadline <span class="keyword">else</span> <span class="string">''</span>,
            <span class="string">'created_at'</span>: todo.created_at.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>),
            <span class="string">'updated_at'</span>: todo.updated_at.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>)
        }
    })

<span class="comment"># 更新任务</span>
@app.route(<span class="string">'/api/todos/&lt;int:todo_id&gt;'</span>, methods=[<span class="string">'PUT'</span>])
@login_required
<span class="keyword">def</span> <span class="function">update_todo</span>(todo_id):
    todo = Todo.query.filter_by(id=todo_id, user_id=session[<span class="string">'user_id'</span>]).first()
    <span class="keyword">if</span> <span class="keyword">not</span> todo:
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">404</span>, <span class="string">'msg'</span>: <span class="string">'任务不存在'</span>}), <span class="number">404</span>
    
    data = request.get_json()
    <span class="keyword">if</span> <span class="string">'title'</span> <span class="keyword">in</span> data:
        todo.title = data[<span class="string">'title'</span>]
    <span class="keyword">if</span> <span class="string">'description'</span> <span class="keyword">in</span> data:
        todo.description = data[<span class="string">'description'</span>]
    <span class="keyword">if</span> <span class="string">'status'</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">'status'</span>] <span class="keyword">in</span> [<span class="string">'pending'</span>, <span class="string">'doing'</span>, <span class="string">'done'</span>]:
        todo.status = data[<span class="string">'status'</span>]
    <span class="keyword">if</span> <span class="string">'priority'</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">'priority'</span>] <span class="keyword">in</span> [<span class="string">'high'</span>, <span class="string">'medium'</span>, <span class="string">'low'</span>]:
        todo.priority = data[<span class="string">'priority'</span>]
    <span class="keyword">if</span> <span class="string">'deadline'</span> <span class="keyword">in</span> data:
        <span class="keyword">try</span>:
            todo.deadline = datetime.strptime(data[<span class="string">'deadline'</span>], <span class="string">'%Y-%m-%d %H:%M:%S'</span>) <span class="keyword">if</span> data[<span class="string">'deadline'</span>] <span class="keyword">else</span> None
        <span class="keyword">except</span>:
            <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">400</span>, <span class="string">'msg'</span>: <span class="string">'日期格式错误'</span>}), <span class="number">400</span>
    
    todo.updated_at = datetime.utcnow()
    db.session.commit()
    
    <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">200</span>, <span class="string">'msg'</span>: <span class="string">'任务更新成功'</span>})

<span class="comment"># 删除任务</span>
@app.route(<span class="string">'/api/todos/&lt;int:todo_id&gt;'</span>, methods=[<span class="string">'DELETE'</span>])
@login_required
<span class="keyword">def</span> <span class="function">delete_todo</span>(todo_id):
    todo = Todo.query.filter_by(id=todo_id, user_id=session[<span class="string">'user_id'</span>]).first()
    <span class="keyword">if</span> <span class="keyword">not</span> todo:
        <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">404</span>, <span class="string">'msg'</span>: <span class="string">'任务不存在'</span>}), <span class="number">404</span>
    
    db.session.delete(todo)
    db.session.commit()
    
    <span class="keyword">return</span> jsonify({<span class="string">'code'</span>: <span class="number">200</span>, <span class="string">'msg'</span>: <span class="string">'任务删除成功'</span>})

<span class="comment"># 初始化数据库（首次运行时执行）</span>
<span class="keyword">with</span> app.app_context():
    db.create_all()

<span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:
    app.run(debug=<span class="keyword">True</span>, host=<span class="string">'0.0.0.0'</span>, port=<span class="number">5000</span>)
</code></pre>
        </div>
        
        <!-- 前端代码 -->
        <div class="code-card" id="frontend-card">
            <button class="copy-btn" onclick="copyCode('frontend')">复制代码</button>
            <span class="copy-success" id="frontend-success">复制成功！</span>
            <pre><code><span class="comment"><!-- index.html - 前端页面核心代码 --></span>
&lt;!DOCTYPE html&gt;
&lt;html lang="zh-CN"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;TECH·G | 任务管理系统&lt;/title&gt;
    &lt;style&gt;
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', system-ui, sans-serif; }
        :root {
            --primary: #22c55e;
            --primary-light: rgba(34, 197, 94, 0.1);
            --secondary: #f97316;
            --dark: #000;
            --dark-card: #0a0a0a;
            --text-primary: #f5f5f5;
            --text-secondary: #aaa;
            --border: rgba(34, 197, 94, 0.1);
        }
        body { background: var(--dark); color: var(--text-primary); min-height: 100vh; }
        
        /* 导航栏 */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 40px;
            border-bottom: 1px solid var(--border);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .logo { color: var(--primary); font-size: 20px; font-weight: 600; text-decoration: none; }
        .user-info { display: flex; align-items: center; gap: 16px; }
        .username { color: var(--text-secondary); font-size: 14px; }
        .btn {
            padding: 6px 16px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-primary { background: var(--primary-light); color: var(--primary); }
        .btn-primary:hover { background: rgba(34, 197, 94, 0.2); }
        .btn-secondary { background: rgba(249, 115, 22, 0.1); color: var(--secondary); }
        .btn-secondary:hover { background: rgba(249, 115, 22, 0.2); }
        
        /* 主容器 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .page-title {
            font-size: 24px;
            margin-bottom: 32px;
            position: relative;
            display: inline-block;
        }
        .page-title::after {
            content: '';
            display: block;
            width: 50px;
            height: 2px;
            background: var(--primary);
            margin-top: 8px;
        }
        
        /* 登录/注册表单 */
        .auth-form {
            max-width: 400px;
            margin: 50px auto;
            background: var(--dark-card);
            padding: 32px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        .form-title {
            font-size: 20px;
            margin-bottom: 24px;
            text-align: center;
            color: var(--primary);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--text-secondary);
        }
        .form-input {
            width: 100%;
            padding: 10px 12px;
            background: var(--dark);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 14px;
        }
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        .form-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .form-btn:hover {
            background: #16a34a;
        }
        .form-switch {
            text-align: center;
            margin-top: 16px;
            font-size: 14px;
            color: var(--text-secondary);
        }
        .form-switch a {
            color: var(--primary);
            text-decoration: none;
            margin-left: 4px;
        }
        
        /* 任务列表 */
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        .filter-group {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .filter-label {
            font-size: 14px;
            color: var(--text-secondary);
        }
        .filter-select {
            padding: 6px 12px;
            background: var(--dark);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 14px;
        }
        .task-list {
            display: grid;
            gap: 16px;
        }
        .task-card {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease, border-color 0.3s ease;
        }
        .task-card:hover {
            transform: translateY(-2px);
            border-color: rgba(34, 197, 94, 0.3);
        }
        .task-header-card {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        .task-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .task-priority {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        .priority-high { background: rgba(248, 113, 113, 0.1); color: #f87171; }
        .priority-medium { background: rgba(24acc1, 0.1); color: #facc15; }
        .priority-low { background: rgba(56, 189, 248, 0.1); color: #38bdf8; }
        .task-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 12px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        .task-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 16px;
        }
        .task-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }
        .task-btn {
            padding: 4px 12px;
            font-size: 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        .btn-edit { background: rgba(34, 197, 94, 0.1); color: var(--primary); }
        .btn-edit:hover { background: rgba(34, 197, 94, 0.2); }
        .btn-delete { background: rgba(248, 113, 113, 0.1); color: #f87171; }
        .btn-delete:hover { background: rgba(248, 113, 113, 0.2); }
        .btn-complete { background: rgba(56, 189, 248, 0.1); color: #38bdf8; }
        .btn-complete:hover { background: rgba(56, 189, 248, 0.2); }
        
        /* 任务模态框 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        .modal {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 24px;
            width: 100%;
            max-width: 500px;
            border: 1px solid var(--border);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .modal-close:hover {
            color: var(--text-primary);
        }
        .modal-body { margin-bottom: 24px; }
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        /* 提示消息 */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 24px;
            border-radius: 4px;
            background: var(--dark-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            z-index: 1000;
            display: none;
            animation: slideIn 0.3s ease;
        }
        .toast-success { border-left: 4px solid var(--primary); }
        .toast-error { border-left: 4px solid #f87171; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* 隐藏元素 */
        .hidden { display: none; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    <!-- 导航栏 -->
    &lt;nav class="navbar" id="navbar"&gt;
        &lt;a href="#" class="logo"&gt;TECH·G 任务管理&lt;/a&gt;
        &lt;div class="user-info"&gt;
            &lt;span class="username" id="username-display"&gt;&lt;/span&gt;
            &lt;button class="btn btn-secondary" id="logout-btn"&gt;退出登录&lt;/button&gt;
        &lt;/div&gt;
    &lt;/nav&gt;

    <!-- 主容器 -->
    &lt;div class="container"&gt;
        <!-- 登录表单 -->
        &lt;div class="auth-form" id="login-form"&gt;
            &lt;h2 class="form-title"&gt;用户登录&lt;/h2&gt;
            &lt;div class="form-group"&gt;
                &lt;label class="form-label" for="login-username"&gt;用户名&lt;/label&gt;
                &lt;input type="text" class="form-input" id="login-username" placeholder="请输入用户名"&gt;
            &lt;/div&gt;
            &lt;div class="form-group"&gt;
                &lt;label class="form-label" for="login-password"&gt;密码&lt;/label&gt;
                &lt;input type="password" class="form-input" id="login-password" placeholder="请输入密码"&gt;
            &lt;/div&gt;
            &lt;button class="form-btn" id="login-submit"&gt;登录&lt;/button&gt;
            &lt;div class="form-switch"&gt;
                还没有账号？&lt;a href="#" id="go-to-register"&gt;立即注册&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        <!-- 注册表单 -->
        &lt;div class="auth-form hidden" id="register-form"&gt;
            &lt;h2 class="form-title"&gt;用户注册&lt;/h2&gt;
            &lt;div class="form-group"&gt;
                &lt;label class="form-label" for="register-username"&gt;用户名&lt;/label&gt;
                &lt;input type="text" class="form-input" id="register-username" placeholder="请输入用户名"&gt;
            &lt;/div&gt;
            &lt;div class="form-group"&gt;
                &lt;label class="form-label" for="register-password"&gt;密码&lt;/&gtlabel;
                &lt;input type="password" class="form-input" id="register-password" placeholder="请输入密码"&gt;
            &lt;/div&gt;
            &lt;button class="form-btn" id="register-submit"&gt;注册&lt;/button&gt;
            &lt;div class="form-switch"&gt;
                已有账号？&lt;a href="#" id="go-to-login"&gt;立即登录&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        <!-- 任务列表页面 -->
        &lt;div class="hidden" id="task-page"&gt;
            &lt;div class="task-header"&gt;
                &lt;h1 class="page-title"&gt;我的任务&lt;/h1&gt;
                &lt;div class="filter-group"&gt;
                    &lt;label class="filter-label" for="status-filter"&gt;筛选：&lt;/label&gt;
                    &lt;select class="filter-select" id="status-filter"&gt;
                        &lt;option value="all"&gt;所有任务&lt;/option&gt;
                        &lt;option value="pending"&gt;待处理&lt;/option&gt;
                        &lt;option value="doing"&gt;进行中&lt;/option&gt;
                        &lt;option value="done"&gt;已完成&lt;/option&gt;
                    &lt;/select&gt;
                    &lt;button class="btn btn-primary" id="add-task-btn"&gt;添加任务&lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="task-list" id="task-list-container"&gt;
                <!-- 任务卡片将通过 JS 动态生成 -->
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    <!-- 添加/编辑任务模态框 -->
    &lt;div class="modal-overlay" id="task-modal"&gt;
        &lt;div class="modal"&gt;
            &lt;div class="modal-header"&gt;
                &lt;h3 class="modal-title" id="modal-title"&gt;添加任务&lt;/h3&gt;
                &lt;button class="modal-close" id="modal-close"&gt;&amp;times;&lt;/button&gt;
            &lt;/div&gt;
            &lt;div class="modal-body"&gt;
                &lt;input type="hidden" id="task-id"&gt;
                &lt;div class="form-group"&gt;
                    &lt;label class="form-label" for="task-title"&gt;任务标题&lt;/label&gt;
                    &lt;input type="text" class="form-input" id="task-title" placeholder="请输入任务标题"&gt;
                &lt;/div&gt;
                &lt;div class="form-group"&gt;
                    &lt;label class="form-label" for="task-description"&gt;任务描述&lt;/label&gt;
                    &lt;textarea class="form-input" id="task-description" rows="3" placeholder="请输入任务描述（可选）"&gt;&lt;/textarea&gt;
                &lt;/div&gt;
                &lt;div class="form-group"&gt;
                    &lt;label class="form-label" for="task-priority"&gt;优先级&lt;/label&gt;
                    &lt;select class="filter-select" id="task-priority"&gt;
                        &lt;option value="high"&gt;高&lt;/option&gt;
                        &lt;option value="medium" selected&gt;中&lt;/option&gt;
                        &lt;option value="low"&gt;低&lt;/option&gt;
                    &lt;/select&gt;
                &lt;/div&gt;
                &lt;div class="form-group"&gt;
                    &lt;label class="form-label" for="task-deadline"&gt;截止日期&lt;/label&gt;
                    &lt;input type="datetime-local" class="form-input" id="task-deadline"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="modal-footer"&gt;
                &lt;button class="btn btn-secondary" id="modal-cancel"&gt;取消&lt;/button&gt;
                &lt;button class="btn btn-primary" id="modal-save"&gt;保存&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    <!-- 提示消息 -->
    &lt;div class="toast" id="toast"&gt;&lt;/div&gt;

    &lt;script&gt;
        // 全局变量
        const API_BASE_URL = 'http://localhost:5000/api';
        let currentTaskId = null;

        // DOM 元素
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const taskPage = document.getElementById('task-page');
        const usernameDisplay = document.getElementById('username-display');
        const taskListContainer = document.getElementById('task-list-container');
        const taskModal = document.getElementById('task-modal');
        const toast = document.getElementById('toast');

        // 页面切换
        document.getElementById('go-to-register').addEventListener('click', (e) => {
            e.preventDefault();
            loginForm.classList.add('hidden');
            registerForm.classList.remove('hidden');
        });

        document.getElementById('go-to-login').addEventListener('click', (e) => {
            e.preventDefault();
            registerForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });

        // 注册功能
        document.getElementById('register-submit').addEventListener('click', async () => {
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value.trim();

            if (!username || !password) {
                showToast('用户名和密码不能为空', 'error');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await response.json();

                if (data.code === 200) {
                    showToast('注册成功，即将跳转登录', 'success');
                    setTimeout(() => {
                        registerForm.classList.add('hidden');
                        loginForm.classList.remove('hidden');
                    }, 1500);
                } else {
                    showToast(data.msg, 'error');
                }
            } catch (error) {
                showToast('网络错误，请稍后重试', 'error');
            }
        });

        // 登录功能
        document.getElementById('login-submit').addEventListener('click', async () => {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value.trim();

            if (!username || !password) {
                showToast('用户名和密码不能为空', 'error');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await response.json();

                if (data.code === 200) {
                    showToast('登录成功', 'success');
                    usernameDisplay.textContent = `欢迎，${data.data.username}`;
                    loginForm.classList.add('hidden');
                    registerForm.classList.add('hidden');
                    taskPage.classList.remove('hidden');
                    fetchTasks(); // 加载任务列表
                } else {
                    showToast(data.msg, 'error');
                }
            } catch (error) {
                showToast('网络错误，请稍后重试', 'error');
            }
        });

        // 退出登录
        document.getElementById('logout-btn').addEventListener('click', async () => {
            try {
                const response = await fetch(`${API_BASE_URL}/logout`, { method: 'POST' });
                const data = await response.json();

                if (data.code === 200) {
                    showToast('退出登录成功', 'success');
                    taskPage.classList.add('hidden');
                    loginForm.classList.remove('hidden');
                    // 清空表单
                    document.getElementById('login-username').value = '';
                    document.getElementById('login-password').value = '';
                }
            } catch (error) {
                showToast('网络错误，请稍后重试', 'error');
            }
        });

        // 加载任务列表
        async function fetchTasks(status = 'all') {
            try {
                const url = status === 'all' 
                    ? `${API_BASE_URL}/todos` 
                    : `${API_BASE_URL}/todos?status=${status}`;
                
                const response = await fetch(url);
                const data = await response.json();

                if (data.code === 200) {
                    renderTasks(data.data);
                } else if (data.code === 401) {
                    // 未登录，跳转登录页
                    taskPage.classList.add('hidden');
                    loginForm.classList.remove('hidden');
                    showToast('请先登录', 'error');
                }
            } catch (error) {
                showToast('加载任务失败', 'error');
            }
        }

        // 渲染任务列表
        function renderTasks(tasks) {
            if (tasks.length === 0) {
                taskListContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        暂无任务，点击"添加任务"创建你的第一个任务吧～
                    </div>
                `;
                return;
            }

            let html = '';
            tasks.forEach(task => {
                const priorityClass = `priority-${task.priority}`;
                const priorityText = task.priority === 'high' ? '高' : task.priority === 'medium' ? '中' : '低';
                const statusText = task.status === 'pending' ? '待处理' : task.status === 'doing' ? '进行中' : '已完成';
                const deadlineText = task.deadline ? new Date(task.deadline).toLocaleString() : '无';

                html += `
                    <div class="task-card" data-id="${task.id}">
                        <div class="task-header-card">
                            <h3 class="task-title">${task.title}</h3>
                            <span class="task-priority ${priorityClass}">${priorityText}</span>
                        </div>
                        <div class="task-meta">
                            <span>状态：${statusText}</span>
                            <span>创建时间：${new Date(task.created_at).toLocaleString()}</span>
                            <span>截止日期：${deadlineText}</span>
                        </div>
                        <div class="task-description">
                            ${task.description || '无描述'}
                        </div>
                        <div class="task-actions">
                            ${task.status !== 'done' ? `
                                <button class="task-btn btn-complete" onclick="updateTaskStatus(${task.id}, 'done')">
                                    标记完成
                                </button>
                            ` : ''}
                            <button class="task-btn btn-edit" onclick="openEditModal(${task.id})">
                                编辑
                            </button>
                            <button class="task-btn btn-delete" onclick="deleteTask(${task.id})">
                                删除
                            </button>
                        </div>
                    </div>
                `;
            });

            taskListContainer.innerHTML = html;
        }

        // 筛选任务
        document.getElementById('status-filter').addEventListener('change', (e) => {
            fetchTasks(e.target.value);
        });

        // 打开添加任务模态框
        document.getElementById('add-task-btn').addEventListener('click', () => {
            currentTaskId = null;
            document.getElementById('modal-title').textContent = '添加任务';
            document.getElementById('task-id').value = '';
            document.getElementById('task-title').value = '';
            document.getElementById('task-description').value = '';
            document.getElementById('task-priority').value = 'medium';
            document.getElementById('task-deadline').value = '';
            taskModal.style.display = 'flex';
        });

        // 打开编辑任务模态框
        async function openEditModal(taskId) {
            currentTaskId = taskId;
            try {
                const response = await fetch(`${API_BASE_URL}/todos/${taskId}`);
                const data = await response.json();

                if (data.code === 200) {
                    const task = data.data;
                    document.getElementById('modal-title').textContent = '编辑任务';
                    document.getElementById('task-id').value = task.id;
                    document.getElementById('task-title').value = task.title;
                    document.getElementById('task-description').value = task.description || '';
                    document.getElementById('task-priority').value = task.priority;
                    // 转换日期格式为 datetime-local 兼容格式
                    if (task.deadline) {
                        const deadline = new Date(task.deadline).toISOString().slice(0, 16);
                        document.getElementById('task-deadline').value = deadline;
                    } else {
                        document.getElementById('task-deadline').value = '';
                    }
                    taskModal.style.display = 'flex';
                }
            } catch (error) {
                showToast('加载任务失败', 'error');
            }
        }

        // 关闭模态框
        document.getElementById('modal-close').addEventListener('click', () => {
            taskModal.style.display = 'none';
        });

        document.getElementById('modal-cancel').addEventListener('click', () => {
            taskModal.style.display = 'none';
        });

        // 保存任务（添加/编辑）
        document.getElementById('modal-save').addEventListener('click', async () => {
            const title = document.getElementById('task-title').value.trim();
            const description = document.getElementById('task-description').value.trim();
            const priority = document.getElementById('task-priority').value;
            const deadline = document.getElementById('task-deadline').value;

            if (!title) {
                showToast('任务标题不能为空', 'error');
                return;
            }

            // 格式化截止日期
            const deadlineFormatted = deadline ? `${deadline}:00` : '';

            const taskData = {
                title,
                description,
                priority,
                deadline: deadlineFormatted
            };

            try {
                let response;
                if (currentTaskId) {
                    // 编辑任务
                    response = await fetch(`${API_BASE_URL}/todos/${currentTaskId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(taskData)
                    });
                } else {
                    // 添加任务
                    response = await fetch(`${API_BASE_URL}/todos`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(taskData)
                    });
                }

                const data = await response.json();
                if (data.code === 200) {
                    showToast(currentTaskId ? '任务更新成功' : '任务创建成功', 'success');
                    taskModal.style.display = 'none';
                    fetchTasks(document.getElementById('status-filter').value);
                } else {
                    showToast(data.msg, 'error');
                }
            } catch (error) {
                showToast(currentTaskId ? '更新任务失败' : '创建任务失败', 'error');
            }
        });

        // 更新任务状态
        async function updateTaskStatus(taskId, status) {
            try {
                const response = await fetch(`${API_BASE_URL}/todos/${taskId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });
                const data = await response.json();

                if (data.code === 200) {
                    showToast('任务状态更新成功', 'success');
                    fetchTasks(document.getElementById('status-filter').value);
                } else {
                    showToast(data.msg, 'error');
                }
            } catch (error) {
                showToast('更新状态失败', 'error');
            }
        }

        // 删除任务
        async function deleteTask(taskId) {
            if (!confirm('确定要删除这个任务吗？')) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/todos/${taskId}`, {
                    method: 'DELETE'
                });
                const data = await response.json();

                if (data.code === 200) {
                    showToast('任务删除成功', 'success');
                    fetchTasks(document.getElementById('status-filter').value);
                } else {
                    showToast(data.msg, 'error');
                }
            } catch (error) {
                showToast('删除任务失败', 'error');
            }
        }

        // 显示提示消息
        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = 'toast';
            toast.classList.add(`toast-${type}`);
            toast.style.display = 'block';

            setTimeout(() => {
                toast.style.display = 'none';
            }, 2000);
        }

        // 点击模态框外部关闭
        taskModal.addEventListener('click', (e) => {
            if (e.target === taskModal) {
                taskModal.style.display = 'none';
            }
        });

        // 初始化页面
        window.addEventListener('load', () => {
            // 检查是否已登录（简单判断，实际项目可使用 localStorage 存储登录状态）
            fetchTasks().catch(() => {
                taskPage.classList.add('hidden');
                loginForm.classList.remove('hidden');
            });
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
        </div>
    </section>

    <footer class="footer">
        <p>© 2025 TECH·G | 极简黑绿科技风</p>
    </footer>

    <script>
        // 标签页切换功能
        function switchTab(tabName) {
            // 隐藏所有卡片
            document.querySelectorAll('.code-card').forEach(card => {
                card.classList.remove('active');
            });
            // 移除所有标签激活状态
            document.querySelectorAll('.code-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            // 激活当前标签和卡片
            document.getElementById(`${tabName}-card`).classList.add('active');
            document.querySelector(`.code-tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
        }

        // 修复复制代码功能 - 支持标签页切换后的精准复制
        function copyCode(tabName) {
            // 获取当前标签页的代码元素
            const codeElement = document.querySelector(`#${tabName}-card pre code`);
            const code = codeElement.textContent;
            const successMsg = document.getElementById(`${tabName}-success`);
            
            navigator.clipboard.writeText(code).then(() => {
                // 显示悬浮窗
                successMsg.classList.add('show');
                // 1.5秒后移除显示类
                setTimeout(() => {
                    successMsg.classList.remove('show');
                }, 1500);
            }).catch(err => {
                console.error('复制失败:', err);
                successMsg.textContent = '复制失败！';
                successMsg.style.color = '#f87171';
                successMsg.style.borderColor = 'rgba(248, 113, 113, 0.3)';
                successMsg.style.background = 'rgba(248, 113, 113, 0.1)';
                successMsg.classList.add('show');
                setTimeout(() => {
                    successMsg.classList.remove('show');
                    // 恢复默认文本和样式
                    setTimeout(() => {
                        successMsg.textContent = '复制成功！';
                        successMsg.style.color = '#22c55e';
                        successMsg.style.borderColor = 'rgba(34, 197, 94, 0.3)';
                        successMsg.style.background = 'rgba(34, 197, 94, 0.1)';
                    }, 300);
                }, 1500);
            });
        }
    </script>
</body>
</html>
